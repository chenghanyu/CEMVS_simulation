{
    "contents" : "################################################################################\n# Complex-valued EMVS: Simulation study 2                                      #\n# The code is based on general complex normal and embed C++ using Rcpp         #\n# Cheng-Han Yu, UC Santa Cruz                                                  #\n################################################################################\nrm(list = ls())\n################################################################################\n# load required packages\n################################################################################\nlibrary(fields)\nlibrary(Matrix) # for sparse matrix (sparseMatrix)\nlibrary(doMC) # simple Parallel computing\nlibrary(mvnfast)\nlibrary(abind)\n################################################################################\n# source required files\n################################################################################\nsource(\"EMVSmainfcn.R\")\nsource(\"./CVEMVS/log_g_sig_noncir.R\")\nsource(\"./CVEMVS/log_prior.R\") # same as circular\nsource(\"./CVEMVS/E_beta_binom_noncir.R\")   # E-step\nsource(\"./CVEMVS/M_beta_noncir.R\") # M-step\nsource(\"./CVEMVS/M_sigma_sig_noncir.R\") # M-step\nsource(\"./CVEMVS/M_theta.R\")  # M-step  same as circular\n\nsource(\"./CVEMVS/EMVSmainfcn_noncir1.R\")\nsource(\"./CVEMVS/EMVSbest.R\") # same as circular\nsource(\"./CVEMVS/EMVSplot.R\") # same as circular\n\nsource(\"./CVEMVS/CEMVSfcnscpp.R\")\nsource(\"./data/loadData.R\")\n\n################################################################################\n# Run the general CV EMVS algorithms \n################################################################################\n# set parameters\n################\nq <- 1\nnn <- n.time * 2\nqq <- q * 2\n# v0s <- 0.006\nv0s <- 0.001 * 1:15\nv1 <- 1\nepsilon <- 1e-3\nthre <- c(0.5, 0.8722)\n\n# CV algorithm\n################\nsystem.time(sim2.em.cpp <- EM_spikecir_cpp_full(X.cplx, Y.cv, v0s, v1 = 1, epsilon = epsilon,\n                                                a_th = 1, b_th = 1, thre = thre[1], \n                                                spike.cor = 0, slab.cor = 0))\n\n# be careful about the index (q, Nvoxels, L)\n# pprob <- sim2.em.cpp$pprob[1, , which(v0s == EMVSbest(sim2.em.cpp)$v0)]\n\n\n\n\n# Plotting\n################\npar(mfrow = c(1, 3), omi = c(0, 0, 0, 0), mar = c(.1, .1, 1.5, .1))\ndata.mean.list <- lapply(list('Re' = dataR.r, 'Im' = dataI.r, 'Mod' = dataM.r, \n                              'Arg' = dataA.r), function(x) apply(x, c(2, 3), mean))\n# Activation maps\nimg_fmri(output = sim2.em.cpp, thre = 0.5, v0s = v0s, v1 = v1, iscplx = TRUE, \n         isstr = FALSE, cex.pt = 1, cpp = TRUE)\n# Strength map\nimg_fmri(output = sim2.em.cpp, thre = 0.5, v0s = v0s, v1 = v1, iscplx = TRUE, \n         isstr = TRUE, title = \"CV Estimated Strength\", isbar = FALSE,\n         cex.main = 1.5, cex.pt = 1, cpp = TRUE)\n\n# Strength map with the color bar\nimg_fmri(output = sim2.em.cpp, thre = 0.5, v0s = v0s, v1 = v1, iscplx = TRUE, \n         isstr = TRUE, title = \"CV Estimated Strength\", isbar = TRUE,\n         cex.main = 1.5, cex.pt = 1, cpp = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1514404975428.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2157567177",
    "id" : "AE39A584",
    "lastKnownWriteTime" : 1514405981,
    "path" : "~/Dropbox/JASA2017revised/code/CVEMVS_sim2.R",
    "project_path" : "CVEMVS_sim2.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}